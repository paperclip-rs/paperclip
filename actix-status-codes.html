
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Defining additional HTTP status codes Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="actix-security.html" />
    
    
    <link rel="prev" href="actix-operation-meta.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="cli.html">
            
                <a href="cli.html">
            
                    
                    CLI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="build-script.html">
            
                <a href="build-script.html">
            
                    
                    Build script
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="compile-checks.html">
            
                <a href="compile-checks.html">
            
                    
                    Compile-time checks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="actix-plugin.html">
            
                <a href="actix-plugin.html">
            
                    
                    Actix-web plugin
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="actix-operation-meta.html">
            
                <a href="actix-operation-meta.html">
            
                    
                    Adding operation metadata
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.2" data-path="actix-status-codes.html">
            
                <a href="actix-status-codes.html">
            
                    
                    Defining additional HTTP status codes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="actix-security.html">
            
                <a href="actix-security.html">
            
                    
                    Defining security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="actix-schema-defaults.html">
            
                <a href="actix-schema-defaults.html">
            
                    
                    Setting schema defaults
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Defining additional HTTP status codes</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="adding-additional-response-status-codes-to-operations">Adding additional response status codes to operations</h2>
<p>Paperclip deduces your API schema using macros (which read the types of handlers and parameter structs at compile time), so in order for paperclip to know what response code sent by the API, it needs type information about it at compile time. It cannot be inferred from response at runtime.</p>
<p>The plugin exports some newtypes which encode this information for the some of the common 2xx codes (<code>200 OK</code>, <code>201 Created</code> and <code>202 Accepted</code>) for JSON responses and <code>204 No Content</code>.</p>
<pre><code class="lang-rust"><span class="hljs-keyword">use</span> paperclip::actix::web::Json;
<span class="hljs-keyword">use</span> paperclip::actix::{CreatedJson, AcceptedJson, NoContent};

<span class="hljs-comment">// 201 Created</span>
<span class="hljs-meta">#[api_v2_operation]</span>
async <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">adopt_pet</span></span>(body: Json&lt;Pet&gt;) -&gt; <span class="hljs-built_in">Result</span>&lt;CreatedJson&lt;Pet&gt;, ()&gt; {
    <span class="hljs-keyword">let</span> pet: Pet = body.into_inner();
    <span class="hljs-comment">// bring the pet home</span>
    <span class="hljs-literal">Ok</span>(CreatedJson(pet))
}
<span class="hljs-comment">// 204 No Content</span>
<span class="hljs-meta">#[api_v2_operation]</span>
async <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">acknowledge_pet</span></span>(body: Json&lt;Pet&gt;) -&gt; NoContent {
    NoContent
}
</code></pre>
<h3 id="manually-defining-error-response-codes">Manually defining error response codes</h3>
<p>Another macro <code>api_v2_errors</code> helps to manually add error response codes.</p>
<pre><code class="lang-rust"><span class="hljs-keyword">use</span> paperclip::actix::api_v2_errors;

<span class="hljs-meta">#[api_v2_errors(
    code=400,
    code=401, description=<span class="hljs-meta-string">&quot;Unauthorized: Can&apos;t read session from header&quot;</span>,
    code=500,
)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">MyError</span></span> {
    <span class="hljs-comment">/* ... */</span>
}
</code></pre>
<p>You can now use this error in handlers and they&apos;ll emit operations containing those response codes.</p>
<pre><code class="lang-rust"><span class="hljs-meta">#[api_v2_operation]</span>
async <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">my_handler</span></span>() -&gt; <span class="hljs-built_in">Result</span>&lt;(), MyError&gt; {
    <span class="hljs-comment">/* ... */</span>
}
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="actix-operation-meta.html" class="navigation navigation-prev " aria-label="Previous page: Adding operation metadata">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="actix-security.html" class="navigation navigation-next " aria-label="Next page: Defining security">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Defining additional HTTP status codes","level":"1.4.2","depth":2,"next":{"title":"Defining security","level":"1.4.3","depth":2,"path":"actix-security.md","ref":"actix-security.md","articles":[]},"previous":{"title":"Adding operation metadata","level":"1.4.1","depth":2,"path":"actix-operation-meta.md","ref":"actix-operation-meta.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"actix-status-codes.md","mtime":"2022-03-04T19:00:21.035Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-03-04T19:03:49.425Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

